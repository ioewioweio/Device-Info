<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–π IP</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f2f5;
            color: #1c1e21;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
        }
        .ip-container {
            background-color: #ffffff;
            padding: 25px 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            min-width: 280px;
        }
        h2 {
            margin-top: 0;
            margin-bottom: 20px;
            color: #333;
            font-size: 1.5em;
        }
        .ip-address {
            margin: 12px 0;
            font-size: 1.15em;
            word-break: break-all; /* –î–ª—è –¥–ª–∏–Ω–Ω—ã—Ö IPv6 –∞–¥—Ä–µ—Å–æ–≤ */
        }
        .label {
            font-weight: 600;
            color: #555;
        }
        .value {
            color: #007bff; /* –°–∏–Ω–∏–π —Ü–≤–µ—Ç –¥–ª—è IP */
            font-weight: 500;
        }
        .loading {
            color: #777;
        }
        .error {
            color: #dc3545; /* –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è –æ—à–∏–±–æ–∫ */
        }
    </style>
</head>
<body>
    <div class="ip-container">
        <h2>üåç –í–∞—à–∏ IP –∞–¥—Ä–µ—Å–∞:</h2>
        <div class="ip-address">
            <span class="label">IPv4:</span>
            <span id="ipv4" class="loading value">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
        <div class="ip-address">
            <span class="label">IPv6:</span>
            <span id="ipv6" class="loading value">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
    </div>

    <script>
        async function fetchIP(url, elementId, ipType) {
            const element = document.getElementById(elementId);
            try {
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à–æ–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 5000); // 5 —Å–µ–∫—É–Ω–¥ —Ç–∞–π–º–∞—É—Ç

                const response = await fetch(url, { signal: controller.signal });
                clearTimeout(timeoutId);

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const ip = await response.text();
                
                // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ (–º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏)
                if (ipType === 'ipv4') {
                    if (!ip.includes('.') || ip.length < 7 || ip.length > 15) { // –û—á–µ–Ω—å –±–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
                         element.textContent = '–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å';
                         element.className = 'error value';
                         return;
                    }
                } else if (ipType === 'ipv6') {
                    if (!ip.includes(':') || ip.length < 10 ) { // –û—á–µ–Ω—å –±–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
                        element.textContent = '–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å';
                        element.className = 'error value';
                        return;
                    }
                }
                
                element.textContent = ip.trim(); // trim() –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
                element.className = 'value';

            } catch (error) {
                console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ ${ipType} —Å ${url}:`, error);
                if (ipType === 'ipv6') {
                    element.textContent = '–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
                } else {
                    element.textContent = '–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å';
                }
                element.className = 'error value';
            }
        }

        // –°–µ—Ä–≤–∏—Å—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è IP:
        // ipv4.icanhazip.com - DNS —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ A-–∑–∞–ø–∏—Å—å (IPv4)
        // ipv6.icanhazip.com - DNS —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ AAAA-–∑–∞–ø–∏—Å—å (IPv6)
        // –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–æ—á–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–∏–ø –∞–¥—Ä–µ—Å–∞.

        fetchIP('https://ipv4.icanhazip.com', 'ipv4', 'ipv4');
        fetchIP('https://ipv6.icanhazip.com', 'ipv6', 'ipv6');

        // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã (api.ipify.org –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å IPv6, –µ—Å–ª–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –Ω–µ–≥–æ)
        // fetchIP('https://api.ipify.org', 'ipv4', 'ipv4'); // –ú–µ–Ω–µ–µ –Ω–∞–¥–µ–∂–Ω–æ –¥–ª—è —á–∏—Å—Ç–æ–≥–æ IPv4
        // fetchIP('https://api6.ipify.org', 'ipv6', 'ipv6'); // –î–ª—è IPv6
    </script>
</body>
</html>